<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">
<div th:replace="~{fragments/layout :: layout(~{::content})}">
    <div th:fragment="content">


<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Messages de notification -->
    <div th:if="${profileSuccess}" class="animate-[slideDown_0.4s_ease-out] mb-6 bg-green-50 border border-green-200 rounded-xl p-4 relative">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-check-circle text-green-500 text-xl"></i>
            </div>
            <div class="ml-3">
                <p class="text-green-800 font-medium" th:text="${profileSuccess}"></p>
            </div>
        </div>
        <button onclick="this.parentElement.style.display='none'" class="absolute top-4 right-4 text-green-400 hover:text-green-600">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div th:if="${profileError}" class="animate-[slideDown_0.4s_ease-out] mb-6 bg-red-50 border border-red-200 rounded-xl p-4 relative">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-circle text-red-500 text-xl"></i>
            </div>
            <div class="ml-3">
                <p class="text-red-800 font-medium" th:text="${profileError}"></p>
            </div>
        </div>
        <button onclick="this.parentElement.style.display='none'" class="absolute top-4 right-4 text-red-400 hover:text-red-600">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div th:if="${addressSuccess}" class="animate-[slideDown_0.4s_ease-out] mb-6 bg-green-50 border border-green-200 rounded-xl p-4 relative">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-check-circle text-green-500 text-xl"></i>
            </div>
            <div class="ml-3">
                <p class="text-green-800 font-medium" th:text="${addressSuccess}"></p>
            </div>
        </div>
        <button onclick="this.parentElement.style.display='none'" class="absolute top-4 right-4 text-green-400 hover:text-green-600">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div th:if="${addressError}" class="animate-[slideDown_0.4s_ease-out] mb-6 bg-red-50 border border-red-200 rounded-xl p-4 relative">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-circle text-red-500 text-xl"></i>
            </div>
            <div class="ml-3">
                <p class="text-red-800 font-medium" th:text="${addressError}"></p>
            </div>
        </div>
        <button onclick="this.parentElement.style.display='none'" class="absolute top-4 right-4 text-red-400 hover:text-red-600">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- En-tête de profil -->
    <div class="text-center mb-12 animate-[fadeIn_0.6s_ease-out]">
        <h1 class="text-5xl font-bold bg-gradient-to-br from-indigo-500 to-purple-600 bg-clip-text text-transparent mb-3" th:text="#{profile.title}">Mon Profil</h1>
        <p class="text-xl text-slate-600" th:text="#{profile.subtitle}">Gérez vos informations personnelles et préférences</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Informations personnelles -->
        <div class="opacity-0 translate-y-8" style="animation-delay: 0.1s;">
            <div class="transition-all duration-300 ease-out hover:-translate-y-2 hover:shadow-2xl bg-white rounded-2xl shadow-lg overflow-hidden h-full">
                <div class="bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-user-circle text-3xl mr-4"></i>
                            <h3 class="text-xl font-semibold" th:text="#{profile.info.title}">Informations personnelles</h3>
                        </div>
                        <button onclick="openModal('profileModal')" class="bg-white hover:bg-slate-50 text-indigo-600 px-4 py-2 rounded-lg transition-all duration-300 flex items-center font-semibold shadow-sm hover:shadow-md">
                            <i class="fas fa-edit mr-2"></i><span th:text="#{profile.info.edit}">Modifier</span>
                        </button>
                    </div>
                </div>
                <div class="p-6">
                    <div class="space-y-6">
                        <div class="group">
                            <div class="flex items-center text-slate-600 mb-2">
                                <i class="fas fa-signature text-indigo-500 w-5"></i>
                                <span class="ml-2 text-sm font-semibold uppercase tracking-wide" th:text="#{profile.info.fullname}">Nom complet</span>
                            </div>
                            <p class="text-lg font-medium text-slate-900 group-hover:text-indigo-600 transition-colors" th:text="${user.fullName}">Nom de l'utilisateur</p>
                        </div>
                        <div class="group">
                            <div class="flex items-center text-slate-600 mb-2">
                                <i class="fas fa-envelope text-indigo-500 w-5"></i>
                                <span class="ml-2 text-sm font-semibold uppercase tracking-wide" th:text="#{profile.info.email}">Adresse e-mail</span>
                            </div>
                            <p class="text-lg font-medium text-slate-900 group-hover:text-indigo-600 transition-colors" th:text="${user.email}">email@exemple.com</p>
                        </div>
                        <div class="group">
                            <div class="flex items-center text-slate-600 mb-2">
                                <i class="fas fa-phone text-indigo-500 w-5"></i>
                                <span class="ml-2 text-sm font-semibold uppercase tracking-wide" th:text="#{profile.info.phone}">Numéro de téléphone</span>
                            </div>
                            <p class="text-lg font-medium text-slate-900 group-hover:text-indigo-600 transition-colors" th:text="${user.phoneNumber}">0123456789</p>
                        </div>
                        <div class="group">
                            <div class="flex items-center text-slate-600 mb-2">
                                <i class="fas fa-tag text-indigo-500 w-5"></i>
                                <span class="ml-2 text-sm font-semibold uppercase tracking-wide" th:text="#{profile.info.brand}">Marque</span>
                            </div>
                            <p class="text-lg font-medium text-slate-900 group-hover:text-indigo-600 transition-colors" th:text="${user.marquee != null && !user.marquee.isEmpty()} ? ${user.marquee} : #{profile.info.not.provided}">Non renseignée</p>
                        </div>

                        <!-- Réseaux sociaux -->
                        <div class="border-t border-slate-200 pt-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center text-slate-600">
                                    <i class="fas fa-share-alt text-indigo-500 w-5"></i>
                                    <span class="ml-2 text-sm font-semibold uppercase tracking-wide">Réseaux sociaux</span>
                                </div>
                            </div>

                            <form th:action="@{/profile/update}" method="post" class="space-y-4">
                                <!-- Facebook -->
                                <div>
                                    <label for="facebookUrlDisplay" class="flex items-center text-sm font-medium text-slate-700 mb-2">
                                        <i class="fab fa-facebook text-blue-600 mr-2"></i>
                                        Page Facebook
                                    </label>
                                    <input type="url"
                                           id="facebookUrlDisplay"
                                           name="facebookUrl"
                                           th:value="${user.socialNetwork != null ? user.socialNetwork.facebookUrl : ''}"
                                           placeholder="https://www.facebook.com/votrepage"
                                           class="w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:outline-none transition-all">
                                </div>

                                <!-- Instagram -->
                                <div>
                                    <label for="instagramUrlDisplay" class="flex items-center text-sm font-medium text-slate-700 mb-2">
                                        <i class="fab fa-instagram text-pink-600 mr-2"></i>
                                        Compte Instagram
                                    </label>
                                    <input type="url"
                                           id="instagramUrlDisplay"
                                           name="instagramUrl"
                                           th:value="${user.socialNetwork != null ? user.socialNetwork.instagramUrl : ''}"
                                           placeholder="https://www.instagram.com/votrecompte"
                                           class="w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 focus:outline-none transition-all">
                                </div>

                                <!-- Champs cachés pour les autres informations du profil -->
                                <input type="hidden" name="fullName" th:value="${user.fullName}">
                                <input type="hidden" name="phoneNumber" th:value="${user.phoneNumber}">
                                <input type="hidden" name="marquee" th:value="${user.marquee}">

                                <!-- Bouton de sauvegarde -->
                                <button type="submit"
                                        class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white font-semibold px-4 py-2 rounded-lg transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg text-sm">
                                    <i class="fas fa-save mr-2"></i>Enregistrer les réseaux sociaux
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gestion des adresses -->
        <div class="opacity-0 translate-y-8" style="animation-delay: 0.2s;">
            <div class="transition-all duration-300 ease-out hover:-translate-y-2 hover:shadow-2xl bg-white rounded-2xl shadow-lg overflow-hidden h-full">
                <div class="bg-gradient-to-r from-cyan-500 to-blue-500 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-map-marker-alt text-3xl mr-4"></i>
                            <h3 class="text-xl font-semibold">Mes Adresses</h3>
                        </div>
                        <span class="bg-white text-cyan-600 px-3 py-1 rounded-full text-sm font-bold" th:text="${addresses.size()}">0</span>
                    </div>
                </div>
                <div class="p-6">
                    <!-- Message si aucune adresse -->
                    <div th:if="${addresses.isEmpty()}" class="text-center py-12">
                        <div class="mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-4">
                            <i class="fas fa-home text-slate-400 text-3xl"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-slate-700 mb-2">Aucune adresse enregistrée</h4>
                        <p class="text-slate-500 mb-6">Ajoutez votre première adresse pour faciliter vos commandes.</p>
                        <button onclick="openModal('addressModal')" class="bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white font-semibold px-6 py-3 rounded-lg transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg">
                            <i class="fas fa-plus mr-2"></i>Ajouter votre première adresse
                        </button>
                    </div>

                    <!-- Liste des adresses existantes -->
                    <div th:unless="${addresses.isEmpty()}" class="space-y-4">
                        <div th:each="address : ${addresses}" class="relative bg-slate-50 rounded-xl p-4 border border-slate-200 hover:border-indigo-300 hover:shadow-md transition-all duration-300">
                            <span class="absolute -top-2 right-4 px-3 py-1 rounded-full text-xs font-bold shadow-sm"
                                  th:classappend="${address.type.name() == 'FACTURATION' ? 'bg-indigo-500 text-white' : 'bg-amber-400 text-amber-900'}"
                                  th:text="${address.type.displayName}">Type</span>

                            <div class="flex justify-between items-start">
                                <div class="flex-1 space-y-2">
                                    <h6 class="font-bold text-indigo-600 text-lg" th:text="${address.nom}">Nom de l'adresse</h6>
                                    <div class="flex items-center text-slate-600">
                                        <i class="fas fa-map-pin w-4 mr-2"></i>
                                        <span th:text="${address.adresse}">Adresse complète</span>
                                    </div>
                                    <div class="flex items-center text-slate-600">
                                        <i class="fas fa-city w-4 mr-2"></i>
                                        <span th:text="${address.ville + ', ' + address.codePostal}">Ville, Code postal</span>
                                    </div>
                                    <div class="flex items-center text-slate-600">
                                        <i class="fas fa-phone w-4 mr-2"></i>
                                        <span th:text="${address.telephone}">Téléphone</span>
                                    </div>
                                </div>
                                <div class="relative">
                                    <button onclick="toggleDropdown(this)" class="p-2 hover:bg-slate-200 rounded-full transition-colors">
                                        <i class="fas fa-ellipsis-v text-slate-400"></i>
                                    </button>
                                    <div class="dropdown-menu hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-10 border">
                                        <a href="#" th:onclick="'editAddress(' + ${address.id} + ')'" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center">
                                            <i class="fas fa-edit text-indigo-500 w-4 mr-2"></i>Modifier
                                        </a>
                                        <hr class="my-1">
                                        <a href="#" th:onclick="'deleteAddress(' + ${address.id} + ')'" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center">
                                            <i class="fas fa-trash w-4 mr-2"></i>Supprimer
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bouton pour ajouter une nouvelle adresse -->
                        <div class="text-center pt-4">
                            <button onclick="openModal('addressModal')" class="bg-white border-2 border-indigo-300 text-indigo-600 hover:bg-indigo-50 font-semibold px-6 py-2 rounded-lg transition-all duration-300">
                                <i class="fas fa-plus mr-2"></i>Ajouter une adresse
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Historique des commandes -->
        <div class="col-span-1 lg:col-span-2 opacity-0 translate-y-8" style="animation-delay: 0.3s;">
            <div class="transition-all duration-300 ease-out hover:-translate-y-2 hover:shadow-2xl bg-white rounded-2xl shadow-lg overflow-hidden">
                <div class="bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-shopping-bag text-3xl mr-4"></i>
                            <h3 class="text-xl font-semibold" th:text="#{profile.orders.history.title}">Historique des commandes</h3>
                        </div>
                        <span class="bg-white text-indigo-600 px-3 py-1 rounded-full text-sm font-bold">
                            <span th:text="${orderHistory.size()}">0</span> <span th:text="#{profile.orders.history.count}">commande(s)</span>
                        </span>
                    </div>
                </div>
                <div class="p-0">
                    <div th:if="${orderHistory.isEmpty()}" class="text-center py-16">
                        <div class="mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-4">
                            <i class="fas fa-shopping-cart text-slate-400 text-3xl"></i>
                        </div>
                        <h4 class="text-xl font-semibold text-slate-700 mb-2" th:text="#{profile.orders.history.no.orders}">Aucune commande pour le moment</h4>
                        <p class="text-slate-500" th:text="#{profile.orders.history.no.orders.desc}">Vos commandes apparaîtront ici une fois effectuées.</p>
                    </div>

                    <div th:unless="${orderHistory.isEmpty()}" class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">
                                        <i class="fas fa-hashtag mr-2"></i><span th:text="#{profile.orders.table.order}">Commande</span>
                                    </th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">
                                        <i class="fas fa-calendar mr-2"></i><span th:text="#{profile.orders.table.date}">Date</span>
                                    </th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">
                                        <i class="fas fa-info-circle mr-2"></i><span th:text="#{profile.orders.table.status}">Statut</span>
                                    </th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">
                                        <i class="fas fa-euro-sign mr-2"></i><span th:text="#{profile.orders.table.total}">Total</span>
                                    </th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider">
                                        <i class="fas fa-cog mr-2"></i><span th:text="#{profile.orders.table.actions}">Actions</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200">
                                <tr th:each="order : ${orderHistory}" class="hover:bg-slate-50 transition-colors">
                                    <td class="px-6 py-4">
                                        <span class="font-bold text-indigo-600" th:text="'#' + ${order.id}">#12345</span>
                                    </td>
                                    <td class="px-6 py-4 text-slate-700" th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">01/01/2023</td>
                                    <td class="px-6 py-4">
                                        <span class="px-3 py-1 rounded-full text-xs font-semibold" th:classappend="${
                                            order.status.name() == 'CREATED' ? 'bg-slate-100 text-slate-800' :
                                            (order.status.name() == 'PAID' ? 'bg-amber-100 text-amber-800' :
                                            (order.status.name() == 'PROCESSING' ? 'bg-blue-100 text-blue-800' :
                                            (order.status.name() == 'SHIPPED' ? 'bg-indigo-100 text-indigo-800' :
                                            (order.status.name() == 'DELIVERED' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'))))
                                        }" th:text="${order.status}">Status</span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <span class="font-bold text-green-600" th:text="${#numbers.formatDecimal(order.total, 1, 2) + ' €'}">50.00€</span>
                                    </td>
                                    <td class="px-6 py-4">
                                        <a th:href="@{'/orders/' + ${order.id}}" class="bg-indigo-50 text-indigo-600 hover:bg-indigo-100 px-4 py-2 rounded-lg text-sm font-semibold transition-colors inline-flex items-center">
                                            <i class="fas fa-eye mr-1"></i><span th:text="#{profile.orders.action.details}">Détails</span>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Modal pour ajouter/modifier une adresse -->
<div id="addressModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
        <div class="p-6 border-b border-slate-200">
            <div class="flex items-center justify-between">
                <h5 class="text-xl font-semibold flex items-center" id="addressModalLabel">
                    <i class="fas fa-plus-circle text-indigo-500 mr-2"></i>
                    Ajouter une adresse
                </h5>
                <button onclick="closeModal('addressModal')" class="text-slate-400 hover:text-slate-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>
        <form th:action="@{/profile/address}" method="post" th:object="${newAddress}">
            <div class="p-6 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="nom" class="block text-sm font-semibold text-slate-700 mb-2">
                            <i class="fas fa-tag text-indigo-500 mr-1"></i>Nom de l'adresse *
                        </label>
                        <input type="text" id="nom" th:field="*{nom}"
                               placeholder="Ex: Maison, Travail..."
                               class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                               required>
                    </div>
                    <div>
                        <label for="type" class="block text-sm font-semibold text-slate-700 mb-2">
                            <i class="fas fa-layer-group text-indigo-500 mr-1"></i>Type d'adresse *
                        </label>
                        <select id="type" th:field="*{type}"
                                class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                                required>
                            <option value="">-- Sélectionner le type --</option>
                            <option th:each="addressType : ${addressTypes}"
                                    th:value="${addressType}"
                                    th:text="${addressType.displayName}">Type</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label for="adresse" class="block text-sm font-semibold text-slate-700 mb-2">
                        <i class="fas fa-map-marker-alt text-indigo-500 mr-1"></i>Adresse complète *
                    </label>
                    <textarea id="adresse" th:field="*{adresse}" rows="3"
                            placeholder="Numéro, rue, résidence, étage..."
                            class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors resize-none"
                            required></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-2">
                        <label for="ville" class="block text-sm font-semibold text-slate-700 mb-2">
                            <i class="fas fa-city text-indigo-500 mr-1"></i>Ville *
                        </label>
                        <input type="text" id="ville" th:field="*{ville}"
                               placeholder="Ex: Paris"
                               class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                               required>
                    </div>
                    <div>
                        <label for="codePostal" class="block text-sm font-semibold text-slate-700 mb-2">
                            <i class="fas fa-mail-bulk text-indigo-500 mr-1"></i>Code postal *
                        </label>
                        <input type="text" id="codePostal" th:field="*{codePostal}"
                               placeholder="Ex: 100000"
                               maxlength="6"
                               pattern="^\d{6}$"
                               title="Le code postal doit contenir exactement 6 chiffres"
                               class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                               required>
                    </div>
                </div>

                <div>
                    <label for="telephone" class="block text-sm font-semibold text-slate-700 mb-2">
                        <i class="fas fa-phone text-indigo-500 mr-1"></i>Téléphone *
                    </label>
                    <input type="tel" id="telephone" th:field="*{telephone}"
                           placeholder="0612345678"
                           pattern="^\d{10}$"
                           maxlength="10"
                           title="Le numéro de téléphone doit contenir exactement 10 chiffres"
                           class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                           required>
                    <p class="mt-1 text-xs text-slate-500">
                        <i class="fas fa-info-circle mr-1"></i>Format : 10 chiffres (ex: 0612345678)
                    </p>
                </div>
            </div>
            <div class="p-6 border-t border-slate-200 flex justify-end space-x-4">
                <button type="button" onclick="closeModal('addressModal')"
                        class="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-lg font-semibold hover:bg-slate-50 transition-colors">
                    <i class="fas fa-times mr-1"></i>Annuler
                </button>
                <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-lg font-semibold transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg">
                    <i class="fas fa-save mr-1"></i>Enregistrer
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Modal de confirmation de suppression -->
<div id="deleteModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4">
        <div class="p-6 border-b border-slate-200">
            <h5 class="text-xl font-semibold text-red-600 flex items-center">
                <i class="fas fa-exclamation-triangle mr-2"></i>
                Confirmer la suppression
            </h5>
        </div>
        <div class="p-6 text-center">
            <div class="mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-trash-alt text-red-500 text-2xl"></i>
            </div>
            <h4 class="text-lg font-semibold text-slate-800 mb-2">Êtes-vous sûr de vouloir supprimer cette adresse ?</h4>
            <p class="text-slate-600">Cette action est irréversible.</p>
        </div>
        <div class="p-6 border-t border-slate-200 flex justify-center space-x-4">
            <button onclick="closeModal('deleteModal')"
                    class="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-lg font-semibold hover:bg-slate-50 transition-colors">
                <i class="fas fa-times mr-1"></i>Annuler
            </button>
            <form id="deleteForm" method="post" style="display: inline;">
                <button type="submit"
                        class="px-6 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition-colors">
                    <i class="fas fa-trash mr-1"></i>Supprimer
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Modal pour modifier le profil -->
<div id="profileModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
        <div class="p-6 border-b border-slate-200">
            <div class="flex items-center justify-between">
                <h5 class="text-xl font-semibold flex items-center">
                    <i class="fas fa-user-edit text-indigo-500 mr-2"></i>
                    Modifier mon profil
                </h5>
                <button onclick="closeModal('profileModal')" class="text-slate-400 hover:text-slate-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>
        <form th:action="@{/profile/update}" method="post">
            <div class="p-6 space-y-6">
                <div>
                    <label for="fullName" class="block text-sm font-semibold text-slate-700 mb-2">
                        <i class="fas fa-signature text-indigo-500 mr-1"></i>Nom complet *
                    </label>
                    <input type="text" id="fullName" name="fullName" th:value="${user.fullName}"
                           placeholder="Votre nom complet"
                           class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                           required>
                </div>

                <div>
                    <label for="phoneNumber" class="block text-sm font-semibold text-slate-700 mb-2">
                        <i class="fas fa-phone text-indigo-500 mr-1"></i>Numéro de téléphone *
                    </label>
                    <input type="tel" id="phoneNumber" name="phoneNumber" th:value="${user.phoneNumber}"
                           placeholder="0612345678"
                           pattern="^\d{10}$"
                           maxlength="10"
                           title="Le numéro de téléphone doit contenir exactement 10 chiffres"
                           class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors"
                           required>
                    <p class="mt-1 text-xs text-slate-500">
                        <i class="fas fa-info-circle mr-1"></i>Format : 10 chiffres (ex: 0612345678)
                    </p>
                </div>

                <div>
                    <label for="marquee" class="block text-sm font-semibold text-slate-700 mb-2">
                        <i class="fas fa-tag text-indigo-500 mr-1"></i>Marque
                    </label>
                    <input type="text" id="marquee" name="marquee" th:value="${user.marquee}"
                           placeholder="Nom de votre marque (optionnel)"
                           class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors">
                    <p class="mt-1 text-xs text-slate-500">
                        <i class="fas fa-info-circle mr-1"></i>Le nom de votre marque ou entreprise (si applicable)
                    </p>
                </div>

                <!-- Section Réseaux Sociaux -->
                <div class="border-t border-slate-200 pt-6">
                    <h6 class="text-lg font-semibold text-slate-800 mb-4 flex items-center">
                        <i class="fas fa-share-alt text-indigo-500 mr-2"></i>Réseaux sociaux
                    </h6>
                    <p class="text-sm text-slate-600 mb-4">Ajoutez vos liens de réseaux sociaux pour être visible par vos clients</p>

                    <div class="space-y-4">
                        <div>
                            <label for="facebookUrl" class="block text-sm font-semibold text-slate-700 mb-2">
                                <i class="fab fa-facebook text-blue-600 mr-1"></i>Page Facebook
                            </label>
                            <input type="url" id="facebookUrl" name="facebookUrl"
                                   th:value="${user.socialNetwork != null ? user.socialNetwork.facebookUrl : ''}"
                                   placeholder="https://www.facebook.com/votrepage"
                                   class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors">
                            <p class="mt-1 text-xs text-slate-500">
                                <i class="fas fa-lightbulb mr-1"></i>Exemple: https://www.facebook.com/maboutique
                            </p>
                        </div>

                        <div>
                            <label for="instagramUrl" class="block text-sm font-semibold text-slate-700 mb-2">
                                <i class="fab fa-instagram text-pink-600 mr-1"></i>Compte Instagram
                            </label>
                            <input type="url" id="instagramUrl" name="instagramUrl"
                                   th:value="${user.socialNetwork != null ? user.socialNetwork.instagramUrl : ''}"
                                   placeholder="https://www.instagram.com/votrecompte"
                                   class="w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:outline-none transition-colors">
                            <p class="mt-1 text-xs text-slate-500">
                                <i class="fas fa-lightbulb mr-1"></i>Exemple: https://www.instagram.com/maboutique
                            </p>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
                    <div class="flex items-start">
                        <i class="fas fa-lock text-slate-400 mt-1 mr-2"></i>
                        <div>
                            <p class="text-sm font-semibold text-slate-700">Adresse e-mail</p>
                            <p class="text-sm text-slate-600" th:text="${user.email}">email@exemple.com</p>
                            <p class="text-xs text-slate-500 mt-1">L'adresse e-mail ne peut pas être modifiée</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="p-6 border-t border-slate-200 flex justify-end space-x-4">
                <button type="button" onclick="closeModal('profileModal')"
                        class="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-lg font-semibold hover:bg-slate-50 transition-colors">
                    <i class="fas fa-times mr-1"></i>Annuler
                </button>
                <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-lg font-semibold transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg">
                    <i class="fas fa-save mr-1"></i>Enregistrer les modifications
                </button>
            </div>
        </form>
    </div>
</div>

<script>
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.add('hidden');
    document.body.style.overflow = 'auto';

    // Réinitialiser le formulaire d'adresse si c'est le modal d'adresse
    if (modalId === 'addressModal') {
        document.getElementById('addressModalLabel').innerHTML = '<i class="fas fa-plus-circle text-indigo-500 mr-2"></i>Ajouter une adresse';
        document.querySelector('#addressModal form').reset();
        document.querySelector('#addressModal form').action = '/profile/address';
    }
}

function toggleDropdown(button) {
    const dropdown = button.nextElementSibling;
    const isHidden = dropdown.classList.contains('hidden');

    // Fermer tous les autres dropdowns
    document.querySelectorAll('.dropdown-menu').forEach(menu => {
        menu.classList.add('hidden');
    });

    // Toggle le dropdown actuel
    if (isHidden) {
        dropdown.classList.remove('hidden');
    }
}

function editAddress(addressId) {
    fetch('/profile/address/' + addressId + '/edit')
        .then(response => response.json())
        .then(address => {
            document.getElementById('addressModalLabel').innerHTML = '<i class="fas fa-edit text-indigo-500 mr-2"></i>Modifier l\'adresse';
            document.getElementById('nom').value = address.nom;
            document.getElementById('type').value = address.type;
            document.getElementById('adresse').value = address.adresse;
            document.getElementById('ville').value = address.ville;
            document.getElementById('codePostal').value = address.codePostal;
            document.getElementById('telephone').value = address.telephone;

            document.querySelector('#addressModal form').action = '/profile/address';
            openModal('addressModal');
        })
        .catch(error => {
            console.error('Erreur:', error);
            alert('Erreur lors du chargement de l\'adresse');
        });
}

function deleteAddress(addressId) {
    document.getElementById('deleteForm').action = '/profile/address/' + addressId + '/delete';
    openModal('deleteModal');
}

// Fermer les dropdowns en cliquant ailleurs
document.addEventListener('click', function(event) {
    if (!event.target.closest('.relative')) {
        document.querySelectorAll('.dropdown-menu').forEach(menu => {
            menu.classList.add('hidden');
        });
    }
});

// Fermer les modals avec Escape
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        document.querySelectorAll('.modal.show').forEach(modal => {
            closeModal(modal.id);
        });
    }
});

// Animation d'entrée pour les cartes au chargement de la page
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('[style*="animation-delay"]');
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 150);
    });
});
</script>

    </div>
</div>
</body>
</html>
